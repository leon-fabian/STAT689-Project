---
title: <center> P7 - Final Report </center>
author: <center> Ram Pangaluri, Ashok Shanker, Fabian Leon </center>
output: html_document
---

### Introduction 
Sorghum [Sorghum *bicolor* (L. Moench)] is the world's fifth most important cereal crop, in terms of both production and area planted. It is an increasingly relevant grain crop due to its resilience to drier and hotter climates. In the United States, sorghum is typically grown in dryland areas in Kansas and Texas with Texas accounting for ~1.8 million of the United States' ~5.8 million acres of sorghum production. The circumstances of where it is grown mean that sorghum usually does not meet its optimal yield potential. To ensure that the best decisions are being made to achieve maximal sorghum yields despite poor growing conditions we attempt to visualize trends in the environmental, genetic, and agronomic factors affecting yield. 


### Motivation
The idea for this visualization project was to use the [Texas A&M Variety Testing](http://varietytesting.tamu.edu/grainsorghum/) and [USDA NASS](https://quickstats.nass.usda.gov/) data repositories on [grain sorghum](https://www.sorghumcheckoff.com/sorghum-101/) production to visualize yield and agricultural production trends for the state of Texas. The first dataset is from Texas A&M Agrilife, which contains data from 1970 - 2021 Texas Sorghum Variety Trials. The second is the dataset from the USDA National Agricultural Statistics website that was collected to reflect this same time period. While agronomists attempt to look at the trends through their research, individual experimental attempts seldom span as long a time period. Visualizing these datasets is the best representation of historical trends for Texas production regions as could be compiled.  

### Visualization Design & Implementation

In our project, the Shiny framework is used for creating a set of 5 visualizations as a web application. Shiny lets us create a reactive application with visualization strategies to choose the processed data displayed as per the project vision. Our development cycle involved creating the basic app with our visualization goals, making changes, and experimenting with the results obtained. User interface components provided by the framework are customized in the back-end as per our methodology to visualize the data to answer the research questions that originated during the proposal. 

Our app consists of five menu items in the dashboard, which let the user choose the desired visualization to appear on the right side of the application. Two of the five items have UI reactivity to let the user play around to compare and contrast the filtered data plots. On the back-end server, the reactive code is extracted out of the app UI enters the server to perform specific visualization where each item is coded to display the output back on the UI. Our front-end is a ShinyDashboard that allows the user to choose a particular visualization with support for interactive functionality. We have used the following techniques in our project: Line Graph, Scatter Plot, Choropleth Map, Racing Bar Graph, and an LMM Analysis. 


### Methodology

The generalized additive model's smoothed line graph of historical yields is a useful tool to see the peaks and valleys of sorghum yields throughout the years. From this plot, we can then retrospectively focus on a certain time period and reflect on what was happening in the industry at that time that might've caused such an increase or decrease in yields. 

A biological system like a sorghum plant or a field of sorghum contains many dependencies and in some sense is a zero-sum system. The correlation plots on the "Trait Relationships" tabs between metrics of hybrid performance indicate the tradeoffs within this crop system. Strong associations can be exploited once visualized with a major example being the association between taller plant height and higher grain yield. 

The choropleth map is a strong visual for historic progress as it allows for the reader to witness where the highest yielding sorghum production zones were in the state throughout history. Additionally this visual allows us to see the clear decline in the number of Texas counties that grew sorghum beginning in the early 2000s. This loss of sorghum acreage is very clearly reflected with the abscence of more and more counties as the map's slider progresses. 

The grain sorghum industry, like the rest of the agricultural industry, has seen consolidation in companies working to produce new hybrid seeds. The racing bar chart in the "Company Brands" tab allows a visual representation of which company brands were most profilic in submitting new hybrid products to these trials throughout history. These bars reflect private seed companies and also public institutions that developed hybrids like Texas A&M or USDA agencies. 

The final tab of the data visualization dashboard addresses the environmental variables and cultural practices affecting grain yield. The expressed aim of this analysis is to visualize the contribution of a limited number of factors to the response variable: grain yield. A more expansive analysis with a model with more terms would only prove harder to visualize and become less meaningul for anyone who is not a subject-matter expert.


### Evaluation Plan

For evaluation, we compare the initial proposal with the final product of the application produced. Each question from the proposal is addressed and checked to determine whether the final product satisfies our project goals. The evaluation for each visualization technique goes as follows:

Line Graph <br>
Goal:<br> Make a line graph with range slider to see how sorghum yields(GY) changed over time and what time periods saw the greatest increases in yield. Users should be able to interact with data and choose date ranges to examine the data closer.<br>
Evaluation: <br>
Overall we were satisfied with the outcome of this attribute of the project. The user interaction objective of this visualization was achieved. Furthermore we also made the line graph display further information on a hover action.

Scatter Plot 

Choropleth Map 

Racing Bar 

LMM Analysis  


### Discussions & Future Work
The final data visualization dashboard encompasses a large breadth of agronomic and historical insights. However, beyond the agronomic practices, further work should be conducted to narrow in on the environmental and genetic components of these trials. This area of study is exceedingly complicated by cross-over interactions between the agronomic practices, environmental conditions, and the plant's genetics. Typically, these interactions are very specific to a production practice or geographic area. These type of research questions are best addressed with targeted experimentation and not well suited for investigation via a large retrospective like we present. 

Delivering these types of trends into the hands of farmers and decision makers is the ultimate goal of these visualizations. Farmers adopting practices is the best best case scenario, however, they are notoriously difficult stakeholders to influence. For example, despite a wealth of previous knowledge and many of our visualizations suggesting that taller plants achieve higher yields, there is still a preference amongst farmers for shorter sorghum hybrids. There exists a misconception that the tallest plants will blow over and lodge despite our data suggesting that only becomes a concern at plant heights taller than ~160cm. As it stands, the average sorghum hybrid height submitted to these trials is ~125cm. There still exists lots of room for greater plant heights in the Texas grain sorghum industry. 

The nature of these data is that they are annually updated with the latest year's production. This work will need to be updated annually to incorporate the most current information into these trends. 

### References
Major References are as follows:<br>
# https://rstudio.github.io/shinydashboard/appearance.html <br>
# https://rstudio.github.io/shinydashboard/structure.html  <br>
Major libraries used in implementing visualizations and R app:<br>
library(shiny)<br>
library(shinythemes)<br>
library(ggplot2)<br>
library(shinydashboard)<br>
library(plotly)<br>
library(dplyr)<br>
library(readr)<br>
library(RColorBrewer)<br>
library(leaflet)<br>
library(ddplot)<br>
library(ggmap)<br>
library(readxl)<br>
library(ddplot) # remotes::install_github("feddelegrand7/ddplot", build_vignettes = TRUE) #used to install ddplot<br>
library(geojsonR)<br>
library(rjson)<br>
library(knitr)<br>

When issues in implementation of app/layout arose, [Stack overflow](https://stackoverflow.com/) and the [R studio community forum](https://community.rstudio.com/) were consulted.<br>








### Team Member Contributions
Ram Pangaluri:<br>
Contributed to design,planning, and writing in P1-5. Helped brainstorm and finalize project story points. Produced preliminary plots for story points and P6 report, including racing bar animation, chloropleth map, and scatterplot variable relationship interaction. Also created intermediate datasets to implement the previous visualizations mentioned. In P7,contributed to writing of the report,as well as implemented workarounds for animation embedding in the shiny app. Contributed R app files and data to team github,and very active in team discord.















